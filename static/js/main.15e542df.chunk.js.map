{"version":3,"sources":["components/Player/Timeline/Timeline.jsx","components/FrequencyGraph/FrequencyGraph.jsx","components/LiveFrequencyGraph/LiveFrequencyGraph.jsx","components/Player/PlayPause/PlayPause.jsx","components/Player/AudioOpener/AudioOpener.jsx","components/Player/Player.jsx","App.jsx","index.js"],"names":["Timeline","PureComponent","_getPrototypeOf2","_this","Object","classCallCheck","this","_len","arguments","length","args","Array","_key","possibleConstructorReturn","getPrototypeOf","call","apply","concat","state","secondsPerPixel","props","audioBuffer","renderCanvas","ctx","canvas","width","Math","ceil","duration","height","audioCtx","window","OfflineAudioContext","sampleRate","sourceNode","createBufferSource","buffer","analyzerNode","createAnalyser","fftSize","smoothingTimeConstant","connect","destination","start","suspendTimes","from","value","index","_this2","frequencySlicesByTimePromises","map","_ref","asyncToGenerator","regenerator_default","a","mark","_callee","time","frequencyData","wrap","_context","prev","next","suspend","Uint8Array","frequencyBinCount","getByteFrequencyData","resume","abrupt","stop","_x","rendering","startRendering","Promise","all","frequencySlicesByTime","canvasWidth","canvasHeight","imageData","getImageData","buf","ArrayBuffer","data","buf8","Uint8ClampedArray","Uint32Array","y","x","gradient","set","putImageData","_this3","offsetPixels","min","max","currentTime","parentElement","clientWidth","react_default","createElement","className","ref","getContext","style","marginLeft","left","type","toString","onInput","onCurrentTimeChange","onClick","onChange","disabled","isPlaying","isWorking","id","accept","e","openFile","setState","reader","FileReader","onload","audioContext","decodeAudioData","target","result","sent","onOpen","readAsArrayBuffer","files","Player","audioBufferKey","startTime","AudioContext","Timeline_Timeline","play","key","PlayPause_Timeline","pause","AudioOpener_Timeline","fileOpened","disconnect","requestAnimationFrame","_this4","updateCurrentTime","_this5","_this6","App","working","Player_Player","console","log","source","Component","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","render","react","src_App_0","document","getElementById"],"mappings":"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","file":"static/js/main.15e542df.chunk.js","sourcesContent":["import React, { PureComponent } from 'react'\r\nimport gradient from '../../gradient.json'\r\nimport './style.css'\r\n\r\nexport default class Timeline extends PureComponent {\r\n  constructor(...args) {\r\n    super(...args)\r\n    this.state = {\r\n      secondsPerPixel: 0.02,\r\n    }\r\n  }\r\n  componentDidMount() {\r\n    if (this.props.audioBuffer)\r\n      this.renderCanvas()\r\n  }\r\n  async renderCanvas() {\r\n    this.ctx.canvas.width = Math.ceil(this.props.audioBuffer ? this.props.audioBuffer.duration / this.state.secondsPerPixel : 0)\r\n    this.ctx.canvas.height = 1024\r\n\r\n    const audioCtx = new window.OfflineAudioContext(2, this.props.audioBuffer.length, this.props.audioBuffer.sampleRate)\r\n\r\n    const sourceNode = audioCtx.createBufferSource()\r\n    sourceNode.buffer = this.props.audioBuffer\r\n    const analyzerNode = audioCtx.createAnalyser()\r\n    analyzerNode.fftSize = this.ctx.canvas.height * 2\r\n    analyzerNode.smoothingTimeConstant = 0\r\n    sourceNode.connect(analyzerNode)\r\n    analyzerNode.connect(audioCtx.destination)\r\n    sourceNode.start()\r\n\r\n    const suspendTimes = Array.from({ length: this.ctx.canvas.width }, (value, index) => this.state.secondsPerPixel * index)\r\n    const frequencySlicesByTimePromises = suspendTimes\r\n      .map(async time => {\r\n        await audioCtx.suspend(time)\r\n        const frequencyData = new Uint8Array(analyzerNode.frequencyBinCount)\r\n        analyzerNode.getByteFrequencyData(frequencyData)\r\n        await audioCtx.resume()\r\n        return frequencyData\r\n      })\r\n    const rendering = audioCtx.startRendering()\r\n    const frequencySlicesByTime = await Promise.all(frequencySlicesByTimePromises)\r\n    const canvasWidth = this.ctx.canvas.width\r\n    const canvasHeight = this.ctx.canvas.height\r\n    const imageData = this.ctx.getImageData(0, 0, canvasWidth, canvasHeight)\r\n\r\n    const buf = new ArrayBuffer(imageData.data.length)\r\n    const buf8 = new Uint8ClampedArray(buf)\r\n    const data = new Uint32Array(buf)\r\n\r\n    for (let y = 0; y < canvasHeight; ++y) {\r\n      for (let x = 0; x < canvasWidth; ++x) {\r\n        const value = frequencySlicesByTime[x][canvasHeight - y - 1]\r\n        data[y * canvasWidth + x] =\r\n                (255 << 24) | // alpha\r\n                (gradient[value][2] << 16) | // blue\r\n                (gradient[value][1] << 8) | // green\r\n                gradient[value][0] // red\r\n      }\r\n    }\r\n    imageData.data.set(buf8)\r\n    this.ctx.putImageData(imageData, 0, 0)\r\n    await rendering\r\n  }\r\n  render () {\r\n    const offsetPixels = Math.min(\r\n      this.ctx ? Math.max(this.props.currentTime / this.state.secondsPerPixel - this.ctx.canvas.parentElement.clientWidth / 2, 0) : 0,\r\n      this.ctx ? this.props.audioBuffer.duration / this.state.secondsPerPixel - this.ctx.canvas.parentElement.clientWidth : 0\r\n    )\r\n    return <div className='timeline'>\r\n      <div className='frequencygraph'>\r\n        <canvas\r\n          ref={canvas => this.ctx = canvas && canvas.getContext('2d')}\r\n          style={{marginLeft: -offsetPixels}}\r\n        ></canvas>\r\n        <div className='timelinepointer' style={{left: this.props.currentTime / this.state.secondsPerPixel - offsetPixels}} />\r\n      </div>\r\n      <input type=\"range\" min=\"0\" max={this.props.audioBuffer ? this.props.audioBuffer.duration.toString() : \"0\"} value={this.props.currentTime} onInput={this.props.onCurrentTimeChange}/>\r\n    </div>\r\n  }\r\n}\r\n","import React, { PureComponent } from 'react'\r\nimport gradient from '../gradient.json'\r\n\r\nexport default class FrequencyGraph extends PureComponent {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.state = {\r\n      working: true\r\n    }\r\n  }\r\n  async componentDidMount () {\r\n    this.canvas.width = 1000\r\n    this.canvas.height = 512\r\n    this.ctx = this.canvas.getContext('2d')\r\n  }\r\n  async componentDidUpdate () {\r\n    if (!this.props.buffer) return\r\n    const audioCtx = new OfflineAudioContext(2, this.props.buffer.length, this.props.buffer.sampleRate)\r\n\r\n    const sourceNode = audioCtx.createBufferSource()\r\n    sourceNode.buffer = this.props.buffer\r\n    const analyzerNode = audioCtx.createAnalyser()\r\n    analyzerNode.fftSize = this.canvas.height * 2\r\n    analyzerNode.smoothingTimeConstant = 0\r\n    sourceNode.connect(analyzerNode)\r\n    analyzerNode.connect(audioCtx.destination)\r\n    sourceNode.start()\r\n\r\n    const suspendTimes = Array.from({ length: this.canvas.width }, (value, index) => this.props.buffer.duration / this.canvas.width * index)\r\n    const frequencySlicesByTimePromises = suspendTimes\r\n      .map(async time => {\r\n        await audioCtx.suspend(time)\r\n        const frequencyData = new Uint8Array(analyzerNode.frequencyBinCount)\r\n        analyzerNode.getByteFrequencyData(frequencyData)\r\n        await audioCtx.resume()\r\n        return frequencyData\r\n      })\r\n    const renderingPromise = audioCtx.startRendering()\r\n    const frequencySlicesByTime = await Promise.all(frequencySlicesByTimePromises)\r\n\r\n    const canvasWidth = this.canvas.width\r\n    const canvasHeight = this.canvas.height\r\n    const imageData = this.ctx.getImageData(0, 0, canvasWidth, canvasHeight)\r\n\r\n    const buf = new ArrayBuffer(imageData.data.length)\r\n    const buf8 = new Uint8ClampedArray(buf)\r\n    const data = new Uint32Array(buf)\r\n\r\n    for (let y = 0; y < canvasHeight; ++y) {\r\n      for (let x = 0; x < canvasWidth; ++x) {\r\n        const value = frequencySlicesByTime[x][canvasHeight - y - 1]\r\n        data[y * canvasWidth + x] =\r\n                (255 << 24) | // alpha\r\n                (gradient[value][2] << 16) | // blue\r\n                (gradient[value][1] << 8) | // green\r\n                gradient[value][0] // red\r\n      }\r\n    }\r\n\r\n    imageData.data.set(buf8)\r\n    this.ctx.putImageData(imageData, 0, 0)\r\n    await renderingPromise\r\n  }\r\n  render () {\r\n    return <canvas\r\n      style={{ background: 'black', display: 'block' }}\r\n      ref={(ref) => this.canvas = ref} />\r\n  }\r\n}\r\n","import React, { PureComponent } from 'react'\r\nimport gradient from '../gradient.json'\r\n\r\nexport default class FrequencyGraph extends PureComponent {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.state = {\r\n      working: true\r\n    }\r\n  }\r\n  async componentDidMount () {\r\n    this.canvas.width = Math.round(document.body.clientWidth / 2) * 2\r\n    this.canvas.height = 512\r\n    this.ctx = this.canvas.getContext('2d')\r\n  }\r\n  async componentDidUpdate () {\r\n    if (this.props.fromNode && this.props.audioContext && !this.state.animating) {\r\n      this.splitterNode = this.props.audioContext.createChannelSplitter(2)\r\n      this.analyzerNodeLeft = this.props.audioContext.createAnalyser()\r\n      this.analyzerNodeRight = this.props.audioContext.createAnalyser()\r\n      this.analyzerNodeLeft.fftSize = this.canvas.height * 2\r\n      this.analyzerNodeLeft.smoothingTimeConstant = 0\r\n      this.analyzerNodeRight.fftSize = this.canvas.height * 2\r\n      this.analyzerNodeRight.smoothingTimeConstant = 0\r\n      this.props.fromNode.connect(this.splitterNode)\r\n      this.splitterNode.connect(this.analyzerNodeLeft, 0)\r\n      this.splitterNode.connect(this.analyzerNodeRight, 0)\r\n      this.animate()\r\n      debugger\r\n      this.setState({ animating: true })\r\n    }\r\n  }\r\n  animate () {\r\n    requestAnimationFrame(this.animate.bind(this))\r\n    const frequencyDataLeft = new Uint8Array(this.analyzerNodeLeft.frequencyBinCount)\r\n    this.analyzerNodeLeft.getByteFrequencyData(frequencyDataLeft)\r\n    const frequencyDataRight = new Uint8Array(this.analyzerNodeRight.frequencyBinCount)\r\n    this.analyzerNodeRight.getByteFrequencyData(frequencyDataRight)\r\n    const canvasWidth = this.canvas.width\r\n    const canvasHeight = this.canvas.height\r\n    const imageDataLeft = this.ctx.getImageData(canvasWidth / 2 - 1, 0, 1, canvasHeight)\r\n    const imageDataRight = this.ctx.getImageData(canvasWidth / 2, 0, 1, canvasHeight)\r\n\r\n    const bufLeft = new ArrayBuffer(imageDataLeft.data.length)\r\n    const buf8Left = new Uint8ClampedArray(bufLeft)\r\n    const dataLeft = new Uint32Array(bufLeft)\r\n\r\n    for (let y = 0; y < canvasHeight; y++) {\r\n      const value = frequencyDataLeft[y]\r\n      dataLeft[canvasHeight - y] =\r\n        (255 << 24) | // alpha\r\n        (gradient[value][2] << 16) | // blue\r\n        (gradient[value][1] << 8) | // green\r\n        gradient[value][0] // red\r\n    }\r\n\r\n    const bufRight = new ArrayBuffer(imageDataRight.data.length)\r\n    const buf8Right = new Uint8ClampedArray(bufRight)\r\n    const dataRight = new Uint32Array(bufRight)\r\n\r\n    for (let y = 0; y < canvasHeight; y++) {\r\n      const value = frequencyDataRight[y]\r\n      dataRight[canvasHeight - y] =\r\n          (255 << 24) | // alpha\r\n          (gradient[value][2] << 16) | // blue\r\n          (gradient[value][1] << 8) | // green\r\n          gradient[value][0] // red\r\n    }\r\n\r\n    imageDataLeft.data.set(buf8Left)\r\n    imageDataRight.data.set(buf8Right)\r\n\r\n    this.ctx.drawImage(this.ctx.canvas, 0, 0, this.canvas.width / 2, this.canvas.height, -1, 0, this.canvas.width / 2, this.canvas.height)\r\n    this.ctx.drawImage(this.ctx.canvas, this.canvas.width / 2, 0, this.canvas.width / 2, this.canvas.height, this.canvas.width / 2 + 1, 0, this.canvas.width / 2, this.canvas.height)\r\n    this.ctx.putImageData(imageDataLeft, this.canvas.width / 2 - 1, 0)\r\n    this.ctx.putImageData(imageDataRight, this.canvas.width / 2, 0)\r\n    // this.ctx.putImageData(imageDataRight, this.canvas.width/2+2, 0)\r\n    // this.ctx.putImageData(imageDataRight, this.canvas.width/2+3, 0)\r\n  }\r\n  render () {\r\n    return <canvas\r\n      style={{ background: 'black', display: 'block' }}\r\n      ref={(ref) => this.canvas = ref} />\r\n  }\r\n}\r\n","import React, { PureComponent } from 'react'\r\nimport './style.css'\r\n\r\nexport default class Timeline extends PureComponent {\r\n  render () {\r\n    return <div className='playpause'>\r\n      <button onClick={this.props.onChange} disabled={this.props.disabled}>{this.props.isPlaying ? 'Pause' : 'Play'}</button>\r\n    </div>\r\n  }\r\n}\r\n","import React, { PureComponent } from 'react'\r\nimport './style.css'\r\n\r\nexport default class Timeline extends PureComponent {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.state = {\r\n      isWorking: false\r\n    }\r\n  }\r\n  render () {\r\n    return <div className='audioopener'>\r\n      <input type='file' id='input' accept='audio/*' onChange={(e) => this.openFile(e)} disabled={this.state.isWorking} />\r\n    </div>\r\n  }\r\n  openFile (e) {\r\n    this.setState({ isWorking: true })\r\n    const reader = new window.FileReader()\r\n    reader.onload = async (e) => {\r\n      const buffer = await this.props.audioContext.decodeAudioData(e.target.result)\r\n      this.setState({ isWorking: false })\r\n      this.props.onOpen(buffer)\r\n    }\r\n    reader.readAsArrayBuffer(e.target.files[0])\r\n  }\r\n}\r\n","import React, { PureComponent } from 'react'\r\nimport Timeline from './Timeline/Timeline'\r\nimport PlayPause from './PlayPause/PlayPause'\r\nimport AudioOpener from './AudioOpener/AudioOpener'\r\n\r\nimport './style.css'\r\n\r\nexport default class Player extends PureComponent {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.state = {\r\n      audioBuffer: null,\r\n      audioBufferKey: 0,\r\n      currentTime: 0, // time in playing file (in seconds)\r\n      startTime: 0, // time of file start in audioContext's reference system\r\n      isPlaying: false\r\n    }\r\n    this.audioContext = new window.AudioContext()\r\n    this.sourceNode = null\r\n  }\r\n  render () {\r\n    return <div className='player'>\r\n      <Timeline audioBuffer={this.state.audioBuffer} currentTime={this.state.currentTime} onCurrentTimeChange={(e) => this.play(+e.target.value)} key={this.state.audioBufferKey}/>\r\n      <PlayPause isPlaying={this.state.isPlaying} onChange={this.state.isPlaying ? () => this.pause() : () => this.play()} disabled={!this.state.audioBuffer} />\r\n      <AudioOpener audioContext={this.audioContext} onOpen={(buffer) => { this.fileOpened(buffer); this.play() }} />\r\n    </div>\r\n  }\r\n  fileOpened (buffer) {\r\n    this.setState((state) => ({\r\n      audioBuffer: buffer,\r\n      audioBufferKey: state.audioBufferKey + 1,\r\n      currentTime: 0,\r\n      startTime: this.audioContext.currentTime\r\n    }), () => {\r\n      if (this.state.isPlaying) {\r\n        this.play()\r\n      }\r\n    })\r\n  }\r\n  async play (time = this.state.currentTime) {\r\n    if (!this.state.audioBuffer) return\r\n    if (this.audioContext.state === 'suspended') {\r\n      await this.audioContext.resume()\r\n    }\r\n    if (this.sourceNode) {\r\n      this.sourceNode.disconnect()\r\n      this.sourceNode.stop()\r\n    }\r\n    this.sourceNode = this.audioContext.createBufferSource()\r\n    this.sourceNode.connect(this.audioContext.destination)\r\n    this.sourceNode.buffer = this.state.audioBuffer\r\n    this.sourceNode.start(0, time)\r\n    this.setState({\r\n      isPlaying: true,\r\n      startTime: this.audioContext.currentTime - time\r\n    })\r\n    requestAnimationFrame(() => this.updateCurrentTime())\r\n  }\r\n  updateCurrentTime() {\r\n    this.setState(state => {\r\n      if (this.state.isPlaying) {\r\n        return {\r\n          currentTime: this.audioContext.currentTime - state.startTime\r\n        }\r\n      }\r\n      return {}\r\n    }, () => requestAnimationFrame(() => this.updateCurrentTime()))\r\n  }\r\n  async pause () {\r\n    this.sourceNode.disconnect()\r\n    this.sourceNode.stop()\r\n    this.sourceNode = null\r\n    this.setState(state => ({\r\n      isPlaying: false,\r\n      currentTime: this.audioContext.currentTime - state.startTime\r\n    }))\r\n  }\r\n}\r\n","import React, { Component } from 'react'\r\nimport './App.css'\r\n\r\nimport FrequencyGraph from './components/FrequencyGraph/FrequencyGraph'\r\nimport LiveFrequencyGraph from './components/LiveFrequencyGraph/LiveFrequencyGraph'\r\nimport Player from './components/Player/Player'\r\n\r\nclass App extends Component {\r\n  constructor (...args) {\r\n    super(...args)\r\n    this.audioContext = new AudioContext()\r\n    this.state = {\r\n      working: false,\r\n      audioBuffer: null\r\n    }\r\n  }\r\n\r\n  render () {\r\n    return <div className='App'>\r\n      {/* <input type=\"file\" id=\"input\" accept=\"audio/*\" onChange={this.openFile}/>\r\n      <button onClick={this.play} disabled={this.state.working || !this.source}>Play</button>\r\n      <FrequencyGraph buffer={this.state.audioBuffer}></FrequencyGraph> */}\r\n      <Player />\r\n      {/* <LiveFrequencyGraph audioContext={this.audioContext} fromNode={this.source}></LiveFrequencyGraph> */}\r\n    </div>\r\n  };\r\n\r\n  async play () {\r\n    console.log(this.audioContext.state)\r\n    if (this.audioContext.state === 'suspended') {\r\n      await this.audioContext.resume()\r\n      console.log('resumed')\r\n    }\r\n    this.source.start(0)\r\n    console.log('started')\r\n  }\r\n}\r\n\r\nexport default App\r\n","import React, { StrictMode } from 'react'\r\nimport { render } from 'react-dom'\r\nimport { Provider } from 'react-redux'\r\nimport { createStore, applyMiddleware, compose } from 'redux'\r\nimport thunk from 'redux-thunk'\r\n\r\nimport App from './App'\r\n// import * as serviceWorker from './serviceWorker';\r\n\r\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose\r\n// const store = createStore(rootReducer, composeEnhancers(applyMiddleware(thunk)))\r\n\r\nrender(\r\n  <StrictMode>\r\n    <App />\r\n  </StrictMode>,\r\n  document.getElementById('root')\r\n)\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\n// serviceWorker.unregister();\r\n"],"sourceRoot":""}